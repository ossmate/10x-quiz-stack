---
import Layout from "../../layouts/Layout.astro";
import { ForgotPasswordWrapper } from "../../components/auth/ForgotPasswordWrapper";

// If there's a recovery token in the URL, redirect to reset password page
// This handles cases where Supabase email template redirects to wrong page
const url = new URL(Astro.request.url);
const hasRecoveryToken = url.searchParams.has("token") || url.hash.includes("type=recovery");

if (hasRecoveryToken) {
  return Astro.redirect("/auth/reset-password" + url.hash);
}

// TODO: If user is authenticated, redirect to change-password instead
// const session = Astro.locals.session;
// if (session) {
//   return Astro.redirect("/auth/change-password");
// }
---

<Layout title="Forgot Password - 10x Quiz Stack" showHeader={false}>
  <ForgotPasswordWrapper client:load />
</Layout>
